---
title: "Encodings and cross-validation"
author: "Michal Burdukiewicz, Piotr Sobczyk"
output: html_document
bibliography: amyloids.bib
---

```{r, echo = FALSE, message = FALSE, results='asis'}
source("./functions/report_functions.R")
source("./functions/plot_tools.R")
```

Date: `r Sys.Date()`

# Data set

The data used in the study was extracted from AmyLoad data base. Aside from eight sequences shorter than five residues that were removed from the final data set, we obtained 418 amyloidogenic sequences and 1039 non-amyloiodegenic sequences (1457 peptides in total).

Sequences shorter than 6 amino acids and longer than 25 amino acids were removed from data set. The final data set contains 397 amyloidogenic and 1033 non-amyloidogenic sequences (1430 peptides in total).


# Encodings of amino acids

The amyloidogenicity of given peptide may not depend on the exact sequence of amino acids, but on its more general properties. To verify this hypothesis, we created 18 537 reduced amino acid alphabets with different lengths (from three to six letters).

## Physicochemical properties

We created the reduced alphabet of amino acids using Ward's clusterization on the selected physicochemical properties. We picked several measures belonging to more general categories important in process of amylodogenicity as size, hydrophobicity, solvent surface area, frequency in $\beta$-sheets and contactivity. As the rule of thumb, we limited ourselves to properties introduced after 1980 when, thanks to the technological advancements, the measurements were more accurate.

We further reduced the number of properties to 17, by selecting measures uncorrelated with others (with the Pearson's correlation coefficient for normalized values larger than 0.95 or smaller than 0.05) since they would create very similar encodings.

```{r, echo = FALSE, message = FALSE, results='asis'}
choose_properties() %>%
  format_property_table %>%
  kable(format = "pandoc")
```

# Training

In addition to the reduced amino acid alphabets created through the clusterization of physicochemical properties, we also examined common reduced alphabets from the literature and raw amino acid sequences.  

Considering that in longer amyloids, only the part of their sequence is responsible for amyloidogenicity, we restricted the maximum length of peptides in training data set to fifteen amino acids. During the training phase, we extracted overlapping hexamers from each sequence. Each hexamer was tagged with the same etiquette (amyloid/nonamyloid) as the original peptide. For example, the sequence of length 6 residues yields only one hexamer and the sequence of 8 residues yields 3 hexamers.

The inquire the exact length of amyloidogenicity signal, we trained nine classifiers for each encoding on the sequences of different length. We considered sequences of length 6, shorter of equal to 10 residues and shorter or equal to 15 residues. We specified separately length of peptides for negative and positive training set, obtaining in total nine classifiers per each encoding.

![alt text](figures/ngram_scheme.png)

# Cross-validation

The cross-validation was repeated ten times for each combination of the encoding as well as the length of sequences in positive data set and negative data set.

The performance measures were calculated separately for four ranges of lengths of sequences in the testing data set:   
1. 6;  
2. 7-10;   
3. 11-15;   
4. more than 15.  
